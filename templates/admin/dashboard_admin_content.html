{% extends 'admin_base.html' %}

{% block title %}Dashboard Admin{% endblock %}

{% block admin_content %}
<style>
    body {
        font-family: 'Poppins', 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        color: #333;
        background-color: #f7f7ff;
        padding: 20px;
    }
    
    h2, h3 {
        color: #7c4dff;
        margin-bottom: 30px;
        font-weight: 600;
        font-size: 28px;
        position: relative;
        padding-bottom: 12px;
        display: inline-block;
        letter-spacing: 0.5px;
    }
    
    h3 {
        font-size: 24px;
    }
    
    .admin-container {
        max-width: 100%;
        margin: 0 auto;
    }
    
    .flash-messages {
        margin-bottom: 25px;
    }
    
    .flash-success {
        background-color: #e8f5e9;
        border-left: 5px solid #00c853;
        padding: 15px 20px;
        border-radius: 8px;
        box-shadow: 0 3px 10px rgba(0, 0, 0, 0.05);
    }
    
    .flash-danger {
        background-color: #ffebee;
        border-left: 5px solid #f44336;
        padding: 15px 20px;
        border-radius: 8px;
        box-shadow: 0 3px 10px rgba(0, 0, 0, 0.05);
    }
    
    .stats-container {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
        gap: 20px;
        margin-bottom: 30px;
    }
    
    .stats-box {
        background-color: #fff;
        border-radius: 12px;
        box-shadow: 0 8px 24px rgba(124, 77, 255, 0.15);
        padding: 20px;
        transition: all 0.2s ease;
    }
    
    .stats-box:hover {
        transform: translateY(-5px);
        box-shadow: 0 12px 30px rgba(124, 77, 255, 0.2);
    }
    
    .stats-box h4 {
        margin: 0 0 15px;
        color: #7c4dff;
        font-size: 1.2em;
        font-weight: 600;
        border-bottom: 1px solid #f0f0ff;
        padding-bottom: 8px;
    }
    
    .stats-box h4 i {
        margin-right: 8px;
        color: #7c4dff;
    }
    
    .stats-list {
        list-style: none;
        padding: 0;
        margin: 0;
    }
    
    .stats-list li {
        margin-bottom: 10px;
        font-size: 0.95em;
        color: #333;
    }
    
    .stats-list li strong {
        color: #000;
        font-size: 1.05em;
    }
    
    .chart-container {
        background-color: #fff;
        border-radius: 16px;
        box-shadow: 0 4px 20px rgba(0, 0, 0, 0.05);
        padding: 20px;
        margin-top: 30px;
        min-height: 400px;
        border: 1px solid rgba(0, 0, 0, 0.05);
    }
    
    .chart-container canvas {
        min-height: 300px;
        width: 100%;
    }
</style>

<div class="admin-container">
    <h2>Dashboard Admin</h2>
    <p>Selamat datang di Panel Admin DimasCash! Berikut ringkasan aktivitas sistem.</p>
    
    {% with messages = get_flashed_messages(with_categories=true) %}
        {% if messages %}
        <div class="flash-messages">
            {% for category, message in messages %}
            <p class="flash-{{ category }}">{{ message }}</p>
            {% endfor %}
        </div>
        {% endif %}
    {% endwith %}
    
    <h3>Statistik Sistem</h3>
    <div class="stats-container">
        <div class="stats-box">
            <h4><i class="fas fa-users"></i> Pengguna</h4>
            <ul class="stats-list">
                <li>Total Admin: <strong>{{ stats.get('total_admins', '?') }}</strong></li>
                <li>Total Penjual: <strong>{{ stats.get('total_vendors', '?') }}</strong> (Aktif: {{ stats.get('active_vendors', '?') }})</li>
                <li>Total Siswa: <strong>{{ stats.get('total_students', '?') }}</strong> (Aktif: {{ stats.get('active_students', '?') }})</li>
            </ul>
        </div>
        <div class="stats-box">
            <h4><i class="fas fa-wallet"></i> Akumulasi Saldo (Aktif)</h4>
            <ul class="stats-list">
                <li>Total Saldo Siswa: <strong>{{ stats.get('total_student_balance', 0)|rupiah }}</strong></li>
                <li>Total Saldo Penjual: <strong>{{ stats.get('total_vendor_balance', 0)|rupiah }}</strong></li>
            </ul>
        </div>
        <div class="stats-box">
            <h4><i class="fas fa-chart-line"></i> Aktivitas Hari Ini ({{ now.strftime('%d %b %Y') if now else 'Hari Ini' }})</h4>
            <ul class="stats-list">
                <li>Total Top Up: <strong style="color: #00c853;">{{ stats.get('total_topups_today', 0)|rupiah }}</strong></li>
                <li>Total Pembayaran: <strong style="color: #7c4dff;">{{ stats.get('total_payments_today', 0)|rupiah }}</strong></li>
                <li>Total Penarikan Tunai: <strong style="color: #ff9800;">{{ stats.get('total_cashouts_today', 0)|rupiah }}</strong></li>
            </ul>
        </div>
    </div>
    
</div>
{% endblock admin_content %}

